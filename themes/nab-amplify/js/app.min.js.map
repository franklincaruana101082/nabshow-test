{"version":3,"sources":["main.js","ouical.js"],"names":["jQuery","$","closeFeedchooser","each","el","this","myCalendar","createCalendar","options","class","data","title","start","Date","end","address","description","append","on","closest","toggleClass","console","log","parent","self","setTimeout","removeClass","clearTimeout","hasClass","panel","attr","text","parents","children","html","panelSlider","addClass","slick","not","fade","cssEase","adaptiveHeight","adContainer","find","adContent","length","trim","wrap","MS_IN_MINUTES","formatTime","date","toISOString","replace","calculateEndTime","event","getTime","duration","calendarGenerators","google","startTime","endTime","encodeURI","join","yahoo","st","getTimezoneOffset","et","ics","eClass","calendarName","document","URL","ical","outlook","generateCalendars","validParams","params","undefined","generateMarkup","calendars","clazz","calendarId","result","createElement","innerHTML","Object","keys","forEach","services","className","id","getClass","getOrGenerateCalendarId","Math","floor","random"],"mappings":"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","file":"app.min.js","sourcesContent":["// Your main script\n\njQuery(function($) {\n\t$('.events-list__event__add').each(function(){\n\t\tlet el = $(this);\n\t\tvar myCalendar = createCalendar({\n\t\t\toptions: {\n\t\t\t\tclass: 'my-calendar-generated-class',\n\t\t\t},\n\t\t\tdata: {\n\t\t\t\ttitle: el.data(\"title\"),     \n\t\t\t\tstart: new Date(el.data(\"start\")),\t\t\t\t\n\t\t\t\tend: new Date(el.data(\"end\")),\n\t\t\t\taddress: el.data(\"address\"),\n\t\t\t\tdescription: el.data(\"description\")\n\t\t\t}\n\t\t});\n\t\tel.append(myCalendar);\n\t});\n\t\n\tjQuery('.js-mobile-toggle').on('click', function() {\n\t\tjQuery(this).closest('.header').toggleClass('_open');\n\t});\n\tjQuery('.js-toggle-feedchooser').on('click', function() {\n\t\tconsole.log('poop');\n\t\tjQuery(this).parent().toggleClass('_open');\n\t});\n\tvar closeFeedchooser;\n\tjQuery('.js-toggle-feedchooser').parent().on('mouseout', function() {\n\t\tvar self = jQuery(this);\n\t\tcloseFeedchooser = setTimeout(function() {\n\t\t\tjQuery(self).removeClass('_open');\n\t\t}, 500);\n\t}).on('mouseover', function() {\n\t\tclearTimeout(closeFeedchooser);\n\t});\n\n\tjQuery('.radiolist li .option').on('click', function() {\n\t\tvar self = jQuery(this);\n\t\tif(jQuery(this).hasClass('_selected')) {\n\t\t\tjQuery('.js-toggle-feedchooser').parent().removeClass('_open');\n\t\t} else {\n\t\t\tvar panel = jQuery(self).attr('data-panel');\n\t\t\tvar title = jQuery(self).text();\n\t\t\tjQuery(self).parents('.showlist').children('.js-toggle-feedchooser').html(title);\n\t\t\tpanel = '.js-panel-'+panel;\n\t\t\tvar panelSlider = panel + ' .slides__list';\n\t\t\tjQuery('.radiolist li .option').removeClass('_selected');\n\t\t\tjQuery(self).addClass('_selected');\n\t\t\tcloseFeedchooser = setTimeout(function() {\n\t\t\t\tjQuery('.js-toggle-feedchooser').parent().removeClass('_open');\n\t\t\t}, 250);\n\t\t\tjQuery('.discover__panel').removeClass('_selected');\n\t\t\tjQuery(panel).addClass('_selected');\n\t\t\tjQuery(panelSlider).slick('setPosition');\n\t\t}\n\n\t});\n\n\n\n\tjQuery('.slides__list').not('.slick-initialized').slick({\n\t\tfade: true,\n\t\tcssEase: 'linear',\n\t\tadaptiveHeight: true\n\t});\n\n\tsetTimeout(function() {\n\t\tjQuery('.discover__ad, .homeproducts__ad').each(function() {\n\t\t\tvar self = jQuery(this);\n\t\t\tvar adContainer = self.find('broadstreet-zone');\n\t\t\tvar adContent = '';\n\t\t\tif(adContainer.length) {\n\t\t \t\tadContent = adContainer.children('div').html().trim();\n\t\t \t}\n\t\t\tif(adContent=='') {\n\t\t\t\tjQuery(self).addClass('_hidden');\n\t\t\t}\n\t\t});\n\t}, 10000);\n\n\tjQuery('.homeproducts__image').wrap('<div class=\"homeproducts__imageWrap\"></div>');\n\n\t//set the url for this woocommerce error link because it's impossible to find where this is in the code/DB\n\tjQuery('.woocommerce-error a.showlogin').attr('href', jQuery('.signup__titles .js-signupLink').attr('href'));\n\t\n});\n","// OuiCal\nvar MS_IN_MINUTES = 60 * 1000;\n\nvar formatTime = function(date) {\n\treturn date.toISOString().replace(/-|:|\\.\\d+/g, '');\n};\n\nvar calculateEndTime = function(event) {\n\treturn event.end ?\n\t\tformatTime(event.end) :\n\t\tformatTime(new Date(event.start.getTime() + (event.duration * MS_IN_MINUTES)));\n};\n\nvar calendarGenerators = {\n\tgoogle: function(event) {\n\t\tvar startTime = formatTime(event.start);\n\t\tvar endTime = calculateEndTime(event);\n\n    console.log('Google event.start', event.start);\n    console.log('Google startTime', startTime);\n\n\t\tvar href = encodeURI([\n\t\t\t'https://www.google.com/calendar/render',\n\t\t\t'?action=TEMPLATE',\n\t\t\t'&text=' + (event.title || ''),\n\t\t\t'&dates=' + (startTime || ''),\n\t\t\t'/' + (endTime || ''),\n\t\t\t'&details=' + (event.description || ''),\n\t\t\t'&location=' + (event.address || ''),\n\t\t\t'&sprop=&sprop=name:'\n\t\t].join(''));\n\t\treturn '<a class=\"icon-google\" target=\"_blank\" href=\"' +\n\t\t\thref + '\">Google</a>';\n\t},\n\n\tyahoo: function(event) {\n\t\t// var eventDuration = event.end ?\n\t\t// \t((event.end.getTime() - event.start.getTime())/ MS_IN_MINUTES) :\n\t\t// \tevent.duration;\n\n\t\t// // Yahoo dates are crazy, we need to convert the duration from minutes to hh:mm\n\t\t// var yahooHourDuration = eventDuration < 600 ?\n\t\t// \t'0' + Math.floor((eventDuration / 60)) :\n\t\t// \tMath.floor((eventDuration / 60)) + '';\n\n\t\t// var yahooMinuteDuration = eventDuration % 60 < 10 ?\n\t\t// \t'0' + eventDuration % 60 :\n\t\t// \teventDuration % 60 + '';\n\n\t\t// var yahooEventDuration = yahooHourDuration + yahooMinuteDuration;\n\n\t\t// Remove timezone from event time\n\t\tvar st = formatTime(new Date(event.start - (event.start.getTimezoneOffset() * MS_IN_MINUTES))) || '';\n    var et = formatTime(new Date(event.end - (event.end.getTimezoneOffset() * MS_IN_MINUTES))) || '';\n\n    \n\t\tvar href = encodeURI([\n\t\t\t'http://calendar.yahoo.com/?v=60&view=d&type=20',\n\t\t\t'&TITLE=' + (event.title || ''),\n      '&ST=' + (st || ''),\n\t\t\t'&ET=' + (et || ''),\n\t\t\t'&DESC=' + (event.description || ''),\n\t\t\t'&in_loc=' + (event.address || '')\n\t\t].join(''));\n\n\t\treturn '<a class=\"icon-yahoo\" target=\"_blank\" href=\"' +\n\t\t\thref + '\">Yahoo!</a>';\n\t},\n\n\tics: function(event, eClass, calendarName) {\n\t\tvar startTime = formatTime(event.start);\n\t\tvar endTime = calculateEndTime(event);\n\n\t\tvar href = encodeURI(\n\t\t\t'data:text/calendar;charset=utf8,' + [\n\t\t\t\t'BEGIN:VCALENDAR',\n\t\t\t\t'VERSION:2.0',\n\t\t\t\t'BEGIN:VEVENT',\n\t\t\t\t'URL:' + document.URL,\n\t\t\t\t'DTSTART:' + (startTime || ''),\n\t\t\t\t'DTEND:' + (endTime || ''),\n\t\t\t\t'SUMMARY:' + (event.title || ''),\n\t\t\t\t'DESCRIPTION:' + (event.description || ''),\n\t\t\t\t'LOCATION:' + (event.address || ''),\n\t\t\t\t'END:VEVENT',\n\t\t\t\t'END:VCALENDAR'].join('\\n'));\n\n\t\treturn '<a class=\"' + eClass + '\" target=\"_blank\" href=\"' +\n\t\t\thref + '\">' + calendarName + '</a>';\n\t},\n\n\tical: function(event) {\n\t\treturn this.ics(event, 'icon-ical', 'iCal');\n\t},\n\n\toutlook: function(event) {\n\t\treturn this.ics(event, 'icon-outlook', 'Outlook');\n\t}\n};\n\nvar generateCalendars = function(event) {\n\treturn {\n\t\tgoogle: calendarGenerators.google(event),\n\t\tyahoo: calendarGenerators.yahoo(event),\n\t\tical: calendarGenerators.ical(event),\n\t\toutlook: calendarGenerators.outlook(event)\n\t};\n};\n\n// Make sure we have the necessary event data, such as start time and event duration\nvar validParams = function(params) {\n\treturn params.data !== undefined && params.data.start !== undefined &&\n\t\t(params.data.end !== undefined || params.data.duration !== undefined);\n};\n\nvar generateMarkup = function(calendars, clazz, calendarId) {\n\tvar result = document.createElement('div');\n\n\tresult.innerHTML = '<label for=\"checkbox-for-' +\n\t\tcalendarId + '\" class=\"add-to-calendar-checkbox\">Add to my Calendar</label>';\n\tresult.innerHTML += '<input name=\"add-to-calendar-checkbox\" class=\"add-to-calendar-checkbox\" id=\"checkbox-for-' + calendarId + '\" type=\"checkbox\">';\n\n\tObject.keys(calendars).forEach(function(services) {\n\t\tresult.innerHTML += calendars[services];\n\t});\n\n\tresult.className = 'add-to-calendar';\n\tif (clazz !== undefined) {\n\t\tresult.className += (' ' + clazz);\n\t}\n\n\tresult.id = calendarId;\n\treturn result;\n};\n\nvar getClass = function(params) {\n\tif (params.options && params.options.class) {\n\t\treturn params.options.class;\n\t}\n};\n\nvar getOrGenerateCalendarId = function(params) {\n\treturn params.options && params.options.id ?\n\t\tparams.options.id :\n\t\tMath.floor(Math.random() * 1000000); // Generate a 6-digit random ID\n};\n\nvar createCalendar = function(params) {\n\tif (!validParams(params)) {\n\t\tconsole.log('Event details missing.');\n\t\treturn;\n\t}\n\n\treturn generateMarkup(generateCalendars(params.data),\n\t\t\t\t\t\t\t\t\t\t\t\tgetClass(params),\n\t\t\t\t\t\t\t\t\t\t\t\tgetOrGenerateCalendarId(params));\n};\nconsole.log('** Create Calendar:', createCalendar);\n"]}