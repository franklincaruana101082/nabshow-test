jQuery(document).ready(function(e){var s=0,t=20,o="",n="",a="",i=document.createElement("p"),r="",d="",c="",p=0,l=[],u=0,m=0,h=0,g=0,f="",y="Sponsors";function b(s,t,o,n){i=document.createElement("p"),void 0!==n&&(i.className=n),r=document.createTextNode(s),i.appendChild(r),"append"!==o&&e(t).html(""),e(i).appendTo(t)}function x(){o={limit:50},jQuery.ajax({type:"GET",dataType:"json",data:o,url:mysHandler.mastercron,beforeSend:function(e){e.setRequestHeader("Authorization","Basic bXVsdGlkb3RzOnRoaW5rZXI5OQ==")},success:function(e){}})}e(".mys-cred-edit").on("click",function(){e(".show-hide-fields").toggleClass("show-labels"),e(this).hide()}),e(".button-sync").on("click",function(){e(".button-sync, .button-sync-exhibitors").addClass("disabled"),e(".process").removeClass("remove-animation").addClass("in-progress").width("30px"),e("#progress-percent").text("0%"),e(".mys-process-bar").show(),e("#progress-percent-outer").slideDown("500"),e(".mys-message-container").slideDown("500",function(){e(".mys-message-container").addClass("show-log-text")}),e(".mys-message-container").html("<p>- Fetching the data from MYS Server..</p>"),function v(C,w,_,T,k){n=-1!==w.indexOf("exhibitor")?"nab_mys_exhibitor_data":"nab_mys_session_data";o={action:n,requested_for:w,group_id:_,total_counts:T,finished_counts:k,past_request:C,security:mysHandler.security};jQuery.ajax({type:"POST",dataType:"json",url:mysHandler.ajaxurl,data:o,success:function(o){return C=void 0!==o.pastItem?o.pastItem:"",w=void 0!==o.requestedFor?o.requestedFor:"",_=void 0!==o.pastItem?o.groupID:"",T=null!==o.totalCounts?o.totalCounts:"",k=null!==o.finishedCounts?o.finishedCounts:"",d=void 0!==o.apiError?o.apiError:"",l=void 0!==o.totalItemStatuses?o.totalItemStatuses:"",u=void 0!==l.Added?l.Added.length:0,m=void 0!==l.Deleted?l.Deleted.length:0,h=void 0!==l.Updated?l.Updated.length:0,""!==d?(e(d).appendTo(".mys-message-container"),e(".process").addClass("remove-animation").removeClass("in-progress").width("30px"),e("#progress-percent").text("0%"),e(".button-sync, .button-sync-exhibitors").removeClass("disabled"),s=0,!1):"finish"!==C?(""!==T&&("exhibitors"===w||"single-exhibitor"===w?(t=100/(p=T),0!==k?b("- The previous pull request ("+_+") is pending. Total "+(k-1)+" out of "+p+" items were finished. So fetching pending item's data from MYS API. New pull request can be started later.",".mys-message-container","append"):(b("- Total "+p+" exhibitors are modified at MYS server.",".mys-message-container","append"),k=0),e(".mys-message-container").append('<p class="exh-counter"></p>')):t=20),"single-exhibitor"===w?(b(k+" out of "+p+" Exhibitors fetched successfully.",".exh-counter"),s=k*t):"exhibitors"!==w&&(a=(a=C.toLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()})).replace("-"," "),1===T&&(a=a.slice(0,-1)),c="","modified-sessions"===C&&(c=" (Total "+u+" to Add / "+m+" to Delete / "+h+" to Update)"),i=document.createElement("p"),r=document.createTextNode("- "+T+" "+a+" fetched successfully."+c),i.appendChild(r),e(i).appendTo(".mys-message-container")),s+=t,s=Math.round(100*s)/100,e(".mys-process-bar .process").width(s+"%"),e("#progress-percent").text(s+"%"),v(C,w,_,T,k),!1):(f=y,g=0,"empty"===w?(b("- Everything is upto date.",".mys-message-container","append","highlighted-para"),g=1):"single-exhibitor"===w?b("- All "+p+" Exhibitors fetched successfully.",".exh-counter"):(1===T&&(f=f.slice(0,-1)),b("- "+T+" "+f+" fetched successfully.",".mys-message-container","append")),0===g&&(setTimeout(function(){e(".mys-message-container").append('<p class="highlighted-para">- The migration process is started now, please check your inbox soon.</p>')},2e3),x()),s=0,e(".process").removeClass("in-progress").addClass("remove-animation"),e(".mys-process-bar .process").width("100%"),e("#progress-percent").text("100%"),void e("#nextstep").fadeIn())},error:function(s,t,o){e(".mys_message_container").text(s+" :: "+t+" :: "+o)}})}("",e(this).data("sync"),"",0,0)}),window.location.href.indexOf("success=1")>-1&&window.location.href.indexOf("exh-inserted")>-1&&x(),e(".popup-btn").on("click",function(){e(this).parent().find(".mys-popup").addClass("active")}),e(".mys-popup .mys-popup-inner .dashicons.dashicons-no").on("click",function(){e(this).parent().parent().removeClass("active")}),e("#datepicker, .enable_date").datepicker({dateFormat:"yy-mm-dd",maxDate:0}),e("#test-mys-close").on("click",function(){e("#mys-test").hide()}),e(".history-filter-button").on("click",function(){e(".current-page:not(.paged_changed)").val(1)}),e(".current-page").keypress(function(s){parseInt(e(".total-pages").text())<parseInt(e(this).val())&&e(".current-page").val(e(".total-pages").text()),e(this).addClass("paged_changed")}),e(".toggle-response").on("click",function(){e("i",this).toggleClass("fa-toggle-on fa-toggle-off"),e(".history-page").toggleClass("show-responses")}),e("#time-hour-csv").on("change",function(){/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(:[0-5][0-9])?$/.test(e(this).val())?e(this).css("border-color","#ddd"):e(this).css("border-color","#fba")})});
