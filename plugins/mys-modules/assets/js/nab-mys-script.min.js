jQuery(document).ready(function(e){var s=0,t=20,o="",n="",a="",i=document.createElement("p"),r="",d="",c="",p=0,l=[],u=0,m=0,h=0,g=0,y="",f="Sponsors";function b(s,t,o,n){i=document.createElement("p"),void 0!==n&&(i.className=n),r=document.createTextNode(s),i.appendChild(r),"append"!==o&&e(t).html(""),e(i).appendTo(t)}e(".mys-cred-edit").on("click",function(){e(".show-hide-fields").toggleClass("show-labels"),e(this).hide()}),e(".button-sync").on("click",function(){e(".button-sync, .button-sync-exhibitors").addClass("disabled"),e(".process").removeClass("remove-animation").addClass("in-progress").width("30px"),e("#progress-percent").text("0%"),e(".mys-process-bar").show(),e("#progress-percent-outer").slideDown("500"),e(".mys-message-container").slideDown("500",function(){e(".mys-message-container").addClass("show-log-text")}),e(".mys-message-container").html("<p>- Fetching the data from MYS Server..</p>"),function x(v,C,_,w,T){n=-1!==C.indexOf("exhibitor")?"nab_mys_exhibitor_data":"nab_mys_session_data";o={action:n,requested_for:C,group_id:_,total_counts:w,finished_counts:T,past_request:v,security:mysHandler.security};jQuery.ajax({type:"POST",dataType:"json",url:mysHandler.ajaxurl,data:o,success:function(n){return v=void 0!==n.pastItem?n.pastItem:"",C=void 0!==n.requestedFor?n.requestedFor:"",_=void 0!==n.pastItem?n.groupID:"",w=null!==n.totalCounts?n.totalCounts:"",T=null!==n.finishedCounts?n.finishedCounts:"",d=void 0!==n.apiError?n.apiError:"",l=void 0!==n.totalItemStatuses?n.totalItemStatuses:"",u=void 0!==l.Added?l.Added.length:0,m=void 0!==l.Deleted?l.Deleted.length:0,h=void 0!==l.Updated?l.Updated.length:0,""!==d?(e(d).appendTo(".mys-message-container"),e(".process").addClass("remove-animation").removeClass("in-progress").width("30px"),e("#progress-percent").text("0%"),e(".button-sync, .button-sync-exhibitors").removeClass("disabled"),s=0,!1):"finish"!==v?(""!==w&&("exhibitors"===C||"single-exhibitor"===C?(t=100/(p=w),0!==T?b("- The previous pull request ("+_+") is pending. Total "+(T-1)+" out of "+p+" items were finished. So fetching pending item's data from MYS API. New pull request can be started later.",".mys-message-container","append"):(b("- Total "+p+" exhibitors are modified at MYS server.",".mys-message-container","append"),T=0),e(".mys-message-container").append('<p class="exh-counter"></p>')):t=20),"single-exhibitor"===C?(b(T+" out of "+p+" Exhibitors fetched successfully.",".exh-counter"),s=T*t):"exhibitors"!==C&&(a=(a=v.toLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()})).replace("-"," "),1===w&&(a=a.slice(0,-1)),c="","modified-sessions"===v&&(c=" (Total "+u+" to Add / "+m+" to Delete / "+h+" to Update)"),i=document.createElement("p"),r=document.createTextNode("- "+w+" "+a+" fetched successfully."+c),i.appendChild(r),e(i).appendTo(".mys-message-container")),s+=t,s=Math.round(100*s)/100,e(".mys-process-bar .process").width(s+"%"),e("#progress-percent").text(s+"%"),x(v,C,_,w,T),!1):(y=f,g=0,"empty"===C?(b("- Everything is upto date.",".mys-message-container","append","highlighted-para"),g=1):"single-exhibitor"===C?b("- All "+p+" Exhibitors fetched successfully.",".exh-counter"):(1===w&&(y=y.slice(0,-1)),b("- "+w+" "+y+" fetched successfully.",".mys-message-container","append")),0===g&&(setTimeout(function(){e(".mys-message-container").append('<p class="highlighted-para">- The migration process is started now, please check your inbox soon.</p>')},2e3),o={limit:50},jQuery.ajax({type:"GET",dataType:"json",data:o,url:mysHandler.mastercron,beforeSend:function(e){e.setRequestHeader("Authorization","Basic bXVsdGlkb3RzOnRoaW5rZXI5OQ==")},success:function(e){}})),s=0,e(".process").removeClass("in-progress").addClass("remove-animation"),e(".mys-process-bar .process").width("100%"),e("#progress-percent").text("100%"),void e("#nextstep").fadeIn())},error:function(s,t,o){e(".mys_message_container").text(s+" :: "+t+" :: "+o)}})}("",e(this).data("sync"),"",0,0)}),e(".popup-btn").on("click",function(){e(this).parent().find(".mys-popup").addClass("active")}),e(".mys-popup .mys-popup-inner .dashicons.dashicons-no").on("click",function(){e(this).parent().parent().removeClass("active")}),e("#datepicker, .enable_date").datepicker({dateFormat:"yy-mm-dd",maxDate:0}),e("#test-mys-close").on("click",function(){e("#mys-test").hide()}),e(".history-filter-button").on("click",function(){e(".current-page:not(.paged_changed)").val(1)}),e(".current-page").keypress(function(s){parseInt(e(".total-pages").text())<parseInt(e(this).val())&&e(".current-page").val(e(".total-pages").text()),e(this).addClass("paged_changed")}),e(".toggle-response").on("click",function(){e("i",this).toggleClass("fa-toggle-on fa-toggle-off"),e(".history-page").toggleClass("show-responses")}),e("#time-hour-csv").on("change",function(){/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(:[0-5][0-9])?$/.test(e(this).val())?e(this).css("border-color","#ddd"):e(this).css("border-color","#fba")})});
