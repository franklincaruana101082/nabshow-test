jQuery(document).ready(function(e){var s=0,t=20,o="",n="",a="",i=document.createElement("p"),r="",d="",c="",l=0,p=[],u=0,m=0,h=0,g=0,f=0,y="",b="Sponsors",v=location.href.split("exh-inserted");function x(e){for(var s=window.location.search.substring(1).split("&"),t=0;t<s.length;t++){var o=s[t].split("=");if(o[0]==e)return o[1]}}function _(s,t,o,n){i=document.createElement("p"),void 0!==n&&(i.className=n),r=document.createTextNode(s),i.appendChild(r),"append"!==o&&e(t).html(""),e(i).appendTo(t)}function C(){o={limit:50},jQuery.ajax({type:"GET",dataType:"json",data:o,url:mysHandler.mastercron,beforeSend:function(e){e.setRequestHeader("Authorization","Basic bXVsdGlkb3RzOnRoaW5rZXI5OQ==")},success:function(e){}})}e(".mys-cred-edit").on("click",function(){e(".show-hide-fields").toggleClass("show-labels"),e(this).hide()}),e(".button-sync").on("click",function(){e(".button-sync, .button-sync-exhibitors").addClass("disabled"),e(".process").removeClass("remove-animation").addClass("in-progress").width("30px"),e("#progress-percent").text("0%"),e(".mys-process-bar").show(),e("#progress-percent-outer").slideDown("500"),e(".mys-message-container").slideDown("500",function(){e(".mys-message-container").addClass("show-log-text")}),e(".mys-message-container").html("<p>- Fetching the data from MYS Server..</p>"),function v(w,T,S,I,k){n=-1!==T.indexOf("exhibitor")?"nab_mys_exhibitor_data":"nab_mys_session_data";var q=x("custom_from_date");var E=x("custom_to_date");o={action:n,requested_for:T,group_id:S,total_counts:I,finished_counts:k,past_request:w,security:mysHandler.security,custom_from_date:q,custom_to_date:E};jQuery.ajax({type:"POST",dataType:"json",url:mysHandler.ajaxurl,data:o,success:function(o){return w=void 0!==o.pastItem?o.pastItem:"",T=void 0!==o.requestedFor?o.requestedFor:"",S=void 0!==o.pastItem?o.groupID:"",I=null!==o.totalCounts?o.totalCounts:"",k=null!==o.finishedCounts?o.finishedCounts:"",u=null!==o.individual?o.individual:0,d=void 0!==o.apiError?o.apiError:"",p=void 0!==o.totalItemStatuses&&null!==o.totalItemStatuses?o.totalItemStatuses:"",m=void 0!==p.Added&&null!==p.Added?p.Added.length:0,h=void 0!==p.Deleted&&null!==p.Deleted?p.Deleted.length:0,g=void 0!==p.Updated&&null!==p.Updated?p.Updated.length:0,""!==d?(e(d).appendTo(".mys-message-container"),e(".process").addClass("remove-animation").removeClass("in-progress").width("30px"),e("#progress-percent").text("0%"),e(".button-sync, .button-sync-exhibitors").removeClass("disabled"),s=0,!1):"finish"!==w?(""!==I&&("exhibitors"===T||"single-exhibitor"===T?(t=100/(l=I),0!==k?_("- The previous pull request ("+S+") is pending. Total "+(k-1)+" out of "+l+" exhibitors were finished. So fetching pending item's data from MYS API. New pull request can be started later.",".mys-message-container","append"):(_("- Total "+l+" exhibitors are modified at MYS server.",".mys-message-container","append"),k=0),e(".mys-message-container").append('<p class="exh-counter"></p>')):1===u?(t=20/(l=I),_(1!==k?"- The previous pull request ("+S+") is pending. Total "+(k-1)+" out of "+l+" sessions were finished individually. So fetching pending item's data from MYS API. New pull request can be started later.":"- Fetching "+l+" sessions individually from MYS server..",".mys-message-container","append"),e(".mys-message-container").append('<p class="sess-counter"></p>')):"sessions"!==T&&(t=20)),"single-exhibitor"===T?(_("- "+k+" out of "+l+" Exhibitors fetched successfully.",".exh-counter"),s=k*t):1===u?(I=l,_("- "+k+" out of "+l+" Sessions fetched successfully.",".sess-counter"),s=20+(k-1)*t):"exhibitors"!==T&&(a=(a=w.toLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()})).replace("-"," "),1===I&&(a=a.slice(0,-1)),c="",c="modified-sessions"===w?" detected.":"sessions"===w?" fetched successfully. (Total "+m+" to Add / "+h+" to Delete / "+g+" to Update)":" fetched successfully.",i=document.createElement("p"),r=document.createTextNode("- "+I+" "+a+c),i.appendChild(r),e(i).appendTo(".mys-message-container")),s+=t,100<(s=Math.round(100*s)/100)&&(s=100),e(".mys-process-bar .process").width(s+"%"),e("#progress-percent").text(s+"%"),v(w,T,S,I,k),!1):(y=b,f=0,"empty"===T?(_("- Everything is upto date.",".mys-message-container","append","highlighted-para"),f=1):"single-exhibitor"===T?_("- All "+l+" Exhibitors fetched successfully.",".exh-counter"):(1===I&&(y=y.slice(0,-1)),_("- "+I+" "+y+" fetched successfully.",".mys-message-container","append")),0===f&&(setTimeout(function(){e(".mys-message-container").append('<p class="highlighted-para">- The migration process is started now, please check your inbox soon.</p>')},2e3),C()),s=0,e(".process").removeClass("in-progress").addClass("remove-animation"),e(".mys-process-bar .process").width("100%"),e("#progress-percent").text("100%"),void e("#nextstep").fadeIn())},error:function(s,t,o){e(".mys_message_container").text(s+" :: "+t+" :: "+o)}})}("",e(this).data("sync"),"",0,0)}),2===v.length&&C(),e(".popup-btn").on("click",function(){e(this).parent().find(".mys-popup").addClass("active")}),e(".mys-popup .mys-popup-inner .dashicons.dashicons-no").on("click",function(){e(this).parent().parent().removeClass("active")}),e("#datepicker, .enable_date").datepicker({dateFormat:"yy-mm-dd",maxDate:0}),e("#test-mys-close").on("click",function(){e("#mys-test").hide()}),e(".history-filter-button").on("click",function(){e(".current-page:not(.paged_changed)").val(1)}),e(".current-page").keypress(function(s){parseInt(e(".total-pages").text())<parseInt(e(this).val())&&e(".current-page").val(e(".total-pages").text()),e(this).addClass("paged_changed")}),e(".toggle-response").on("click",function(){e("i",this).toggleClass("fa-toggle-on fa-toggle-off"),e(".history-page").toggleClass("show-responses")}),e("#time-hour-csv").on("change",function(){/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(:[0-5][0-9])?$/.test(e(this).val())?e(this).css("border-color","#ddd"):e(this).css("border-color","#fba")})});
